<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Booster Clicker Overlay</title>
  <style>
    body { margin: 0; background: transparent; overflow: hidden; font-family: Arial; }
    
    /* MESSAGE D'ACTIVATION */
    #status {
      position: absolute; top: 20px; left: 20px;
      background: rgba(0, 0, 0, 0.7); color: white;
      padding: 10px 15px; border-radius: 10px;
      font-size: 16px; font-weight: bold;
      z-index: 10000; opacity: 0;
      transition: opacity 1s ease;
    }
    #status.show { opacity: 1; }

    /* BOOSTER POP-UP */
    #booster {
      position: absolute; width: 110px; height: 110px;
      background: radial-gradient(circle, #00ffaa, #00cc88); border-radius: 20px;
      box-shadow: 0 0 30px #00ffaa; cursor: pointer;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      color: white; font-weight: bold; opacity: 0; transition: opacity 0.5s;
      animation: pulse 1.5s infinite; z-index: 9999;
    }
    #booster.show { opacity: 1; }
    #booster:hover { transform: scale(1.1); }
    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 30px #00ffaa; }
      50% { box-shadow: 0 0 50px #00ffaa; }
    }
    #booster img { width: 60px; }
  </style>
</head>
<body>

  <!-- MESSAGE D'ACTIVATION -->
  <div id="status">EXTENSION ACTIVE !</div>

  <!-- BOOSTER POP-UP -->
  <div id="booster">
    <img src="https://i.imgur.com/placeholder.png" alt="Logo"> <!-- Ton logo ici -->
    <div>CLIQUE !</div>
  </div>

  <!-- SON -->
  <audio id="sound" src="https://freesound.org/data/previews/276/276094_5094886-lq.mp3"></audio>

  <!-- SDK TWITCH -->
  <script src="https://extension-files.twitch.tv/helper/v1/twitch-ext.min.js"></script>
  <script>
    const status = document.getElementById('status');
    const booster = document.getElementById('booster');
    const sound = document.getElementById('sound');
    let isActive = false;

    // === MESSAGE "EXTENSION ACTIVE !" ===
    window.Twitch.ext.onAuthorized(() => {
      status.classList.add('show');
      setTimeout(() => {
        status.classList.remove('show');
      }, 3000); // Disparaît après 3s
    });

    // === SPAWN BOOSTER ===
    function spawn() {
      if (isActive) return;
      const x = Math.random() * (window.innerWidth - 150);
      const y = Math.random() * (window.innerHeight - 200);
      booster.style.left = x + 'px';
      booster.style.top = y + 'px';
      booster.classList.add('show');
      sound.currentTime = 0;
      sound.play().catch(() => {});
      isActive = true;

      setTimeout(() => {
        if (booster.classList.contains('show')) hide();
      }, 15000);
    }

    function hide() {
      booster.classList.remove('show');
      isActive = false;
    }

    // === CLIC SUR BOOSTER ===
    booster.onclick = () => {
      if (!isActive) return;
      window.Twitch.ext.send('broadcast', 'application/json', JSON.stringify({ action: 'claimed' }));
      hide();
      alert('TU AS GAGNÉ LE BOOSTER !');
    };

    // === SYNC DISPARITION ===
    window.Twitch.ext.listen('broadcast', (target, type, msg) => {
      if (type === 'application/json') {
        const data = JSON.parse(msg);
        if (data.action === 'claimed') hide();
      }
    });

    // === TIMER : 10s pour test, puis 30-60 min ===
    setTimeout(() => {
      spawn();
      setInterval(spawn, Math.random() * (3600000 - 1800000) + 1800000);
    }, 10000);
  </script>
</body>
</html>
